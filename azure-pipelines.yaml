trigger:
- main
- release/*
- development

pr:
- development

pool: AzureWorkflowTutorial

variables:
  isFeature: $[eq(variables['System.PullRequest.SourceBranch'], 'feature/')]
  isRelease: $[eq(variables['Build.SourceBranch'], 'release/*')]
  isDevelopment: $[eq(variables['Build.SourceBranch'], 'development')]
  isMain: $[eq(variables['Build.SourceBranch'], 'main')]
  global_variable: global_value    # this is available to all jobs

stages:
- stage:
  displayName: Build
  variables:
    stage_variable: stage_variable
  jobs:
  - job:
    variables:
      job_variable: job_variable
    steps:
      - task: Bash@3
        displayName: Build Stage
        inputs:
          targetType: 'inline'
          script: |
            stringContain() { [ -z "${2##*$1*}" ]; }
            echo "Build reason is: $(Build.Reason)"
            echo "Build id is: $(Build.BuildId)"
            echo "Build source version is: $(Build.SourceVersion)"
            echo "Build source branch is: $(Build.SourceBranch)"
            echo "PR source branch: $(System.PullRequest.SourceBranch)"
            echo "PR target branch: $(System.PullRequest.TargetBranch)"
            echo "is feat?: $(stringContain $System.PullRequest.SourceBranch 'feat';  then echo yes; else echo no; fi)"
            echo "is release?: $(isRelease)"
            echo "is dev?: $(isDevelopment)"
            echo "is main?: $(isMain)"
            echo "I'm the build stage"